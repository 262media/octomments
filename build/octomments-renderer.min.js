!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=n||self).OctommentsRenderer=t()}(this,function(){"use strict";var l="O_",a=function(n){var t=0<arguments.length&&void 0!==n?n:24;return'<svg width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>')};function m(n){return document.querySelector(n)}function u(n,t,o,e){var a=0<arguments.length&&void 0!==n?n:"div",c=1<arguments.length&&void 0!==t?t:"",i=2<arguments.length&&void 0!==o?o:null,r=3<arguments.length&&void 0!==e?e:null,s=document.createElement(a);return s.setAttribute("class",l+c),i&&i.appendChild(s),r&&(s.innerHTML=r),s}function g(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function v(n,t){var o=m(n);o?o.addEventListener("click",t):console.warn("Octomments: ".concat(n," element doesn't exists in the DOM"))}function f(e,c){var n={},o="idle";function i(n){g(e),u("div","error",e,"<div>".concat(n,"</div>"))}return n.loading=function(){o="loading",g(e),u("small","loading",e,"Loading comments ...")},n.noComments=function(){o="idle",g(e)},n.data=function(n,t){"loading"===o&&(o="data",g(e)),n.forEach(function(n){var t,o;u("div","comment",e,'\n          <div class="'.concat(l,'comment_left">\n            <img src="').concat(n.author.avatarUrl,'" />\n          </div>\n          <div class="').concat(l,'comment_right">\n            <div class="').concat(l,'comment_heading">\n              <strong>').concat(n.author.login,"</strong>\n              <small> ~ ").concat((t=n.updatedAt,o=new Date(t),"".concat(o.getDate(),".").concat(o.getMonth()+1,".").concat(o.getFullYear())),'</small>\n              <a href="').concat(n.url,'" target="_blank" class="').concat(l,'right">').concat(a(16),'</a>\n            </div>\n            <div class="').concat(l,'comment_body">\n              ').concat(n.body,"\n            </div>\n          </div>\n        "))})},c.on(c.ERROR,function(n,t){var o=c.options,e=o.number,a=o.github;1===t?i("Issue <strong>#".concat(e,"</strong> doesn't exists at <a href=\"https://github.com/").concat(a.owner,"/").concat(a.repo,'/issues" target="_blank">').concat(a.repo," repo</a>.")):2!==t&&3!==t&&4!==t||(i('There is a problem fetching the comments. Wait a bit and click <a href="javascript:void(0);" id="'.concat(l,'comments_try_again">here</a> to try again.')),v("#".concat(l,"comments_try_again"),c.initComments))}),n}return function(n,t){var o=m(t);if(!o)throw new Error("Octomments: invalid container selector.");var a,e,c,i=u("div","root",o),r=f(u("div","comments",i),n),s=(a=u("div","new-comment",i),e=n,(c={}).loading=function(){g(a),u("small","loading",a,"Loading user ...")},c.noUser=function(n){g(a),u("div","loading",a,'<a href="'.concat(n,'" class="as-button">✍️ Post a comment</a>'))},c.form=function(){var n=e.user;if(!n)return c.loading();g(a),u("div","comment",a,'\n        <div class="'.concat(l,'comment_left" id="').concat(l,'new_comment">\n          <img src="').concat(n.avatarUrl,'" />\n        </div>\n        <div class="').concat(l,'comment_right">\n          <textarea id="').concat(l,'_textarea" placeholder="I think ..."></textarea>\n          <button id="').concat(l,'_submit_comment">Comment</button>\n          <a href="javascript:void(0);" id="').concat(l,'logout" class="').concat(l,"right ").concat(l,'logout"><small>Log out</small></a>\n        </div>\n    ')),v("#".concat(l,"_submit_comment"),function(){var n=m("#".concat(l,"_textarea")).value;""!==n&&e.add(n)}),v("#".concat(l,"logout"),function(){e.logout()})},e.on(e.ERROR,function(n,t){1===t?g(a):5===t?(e.logout(!1),c.noUser(e.generateNewCommentURL())):6===t||7===t||10===t?(d('There is a problem initializing your user. Wait a bit and click <a href="javascript:void(0);" id="'.concat(l,'user_try_again">here</a> to try again.')),v("#".concat(l,"user_try_again"),e.initUser)):8===t?d("There is a problem posting your comment. Please try again in a couple of minutes.",!1,m(".".concat(l,"comment_right"))).style.marginTop="1em":9===t&&(e.logout(!1),d('Not authorized. Click <a href="javascript:void(0);" id="'.concat(l,'user_login">here</a> to login again.')),v("#".concat(l,"user_login"),e.initUser))}),c);function d(n,t,o){var e=2<arguments.length&&void 0!==o?o:a;return(!(1<arguments.length&&void 0!==t)||t)&&g(a),u("div","error_user",e,"<div>".concat(n,"</div>"))}n.on(n.COMMENTS_LOADING,r.loading).on(n.COMMENTS_LOADED,r.data).on(n.USER_LOADING,s.loading).on(n.USER_NONE,s.noUser).on(n.USER_LOADED,s.form).on(n.COMMENT_SAVING,function(){m("#".concat(l,"new_comment")).style.opacity=.4;var n=m("#".concat(l,"_submit_comment")),t=m("#".concat(l,"_textarea"));n.disabled=!0,t.disabled=!0,n.innerHTML="Posting your comment ..."}).on(n.COMMENT_SAVED,function(n){s.form(),r.data(n)})}});